# Used to be a bug in versions < 1.02
libname:="..",libname:
with(TestTools):

d:=3;
f:=y*(1 + add(a[k]*y^k, k=1..d));
II:=1/f^n/n:
Integral:=Int(II,y=-1..1):
res:=
[128*n^4*D[n]^3*a[1]^6*a[3]^2-68*n^4*D[n]^3*a[1]^5*a[2]^2*a[3]+9*n^4*D[n]^3*a[1]^4*a[2]^4+512*n^
4*D[n]^2*a[1]^7*a[3]^2-272*n^4*D[n]^2*a[1]^6*a[2]^2*a[3]+36*n^4*D[n]^2*a[1]^5*a[2]^4-1008*n^4*D[
n]^3*a[1]^4*a[2]*a[3]^2+506*n^4*D[n]^3*a[1]^3*a[2]^3*a[3]-63*n^4*D[n]^3*a[1]^2*a[2]^5-4288*n^4*D
[n]^2*a[1]^5*a[2]*a[3]^2+2160*n^4*D[n]^2*a[1]^4*a[2]^3*a[3]-270*n^4*D[n]^2*a[1]^3*a[2]^5+808*n^3
*D[n]^3*a[1]^6*a[3]^2-430*n^3*D[n]^3*a[1]^5*a[2]^2*a[3]+57*n^3*D[n]^3*a[1]^4*a[2]^4+2464*n^3*D[n
]^2*a[1]^7*a[3]^2-1312*n^3*D[n]^2*a[1]^6*a[2]^2*a[3]+174*n^3*D[n]^2*a[1]^5*a[2]^4+1296*n^4*D[n]^
3*a[1]^3*a[3]^3+1593*n^4*D[n]^3*a[1]^2*a[2]^2*a[3]^2-918*n^4*D[n]^3*a[1]*a[2]^4*a[3]+108*n^4*D[n
]^3*a[2]^6+6336*n^4*D[n]^2*a[1]^4*a[3]^3+6720*n^4*D[n]^2*a[1]^3*a[2]^2*a[3]^2-4050*n^4*D[n]^2*a[
1]^2*a[2]^4*a[3]+486*n^4*D[n]^2*a[1]*a[2]^6+4096*n^4*D[n]*a[1]^5*a[3]^3-5760*n^4*D[n]*a[1]^4*a[2
]^2*a[3]^2+2160*n^4*D[n]*a[1]^3*a[2]^4*a[3]-243*n^4*D[n]*a[1]^2*a[2]^6-6360*n^3*D[n]^3*a[1]^4*a[
2]*a[3]^2+3199*n^3*D[n]^3*a[1]^3*a[2]^3*a[3]-399*n^3*D[n]^3*a[1]^2*a[2]^5-20624*n^3*D[n]^2*a[1]^
5*a[2]*a[3]^2+10416*n^3*D[n]^2*a[1]^4*a[2]^3*a[3]-1305*n^3*D[n]^2*a[1]^3*a[2]^5+1648*n^2*D[n]^3*
a[1]^6*a[3]^2-880*n^2*D[n]^3*a[1]^5*a[2]^2*a[3]+117*n^2*D[n]^3*a[1]^4*a[2]^4+4048*n^2*D[n]^2*a[1
]^7*a[3]^2-2164*n^2*D[n]^2*a[1]^6*a[2]^2*a[3]+288*n^2*D[n]^2*a[1]^5*a[2]^4-4860*n^4*D[n]^3*a[1]*
a[2]*a[3]^3+1161*n^4*D[n]^3*a[2]^3*a[3]^2-24192*n^4*D[n]^2*a[1]^2*a[2]*a[3]^3+6480*n^4*D[n]^2*a[
1]*a[2]^3*a[3]^2-162*n^4*D[n]^2*a[2]^5*a[3]-7680*n^4*D[n]*a[1]^3*a[2]*a[3]^3+17280*n^4*D[n]*a[1]
^2*a[2]^3*a[3]^2-6804*n^4*D[n]*a[1]*a[2]^5*a[3]+729*n^4*D[n]*a[2]^7+8154*n^3*D[n]^3*a[1]^3*a[3]^
3+10044*n^3*D[n]^3*a[1]^2*a[2]^2*a[3]^2-5802*n^3*D[n]^3*a[1]*a[2]^4*a[3]+684*n^3*D[n]^3*a[2]^6+
30384*n^3*D[n]^2*a[1]^4*a[3]^3+32280*n^3*D[n]^2*a[1]^3*a[2]^2*a[3]^2-19521*n^3*D[n]^2*a[1]^2*a[2
]^4*a[3]+2349*n^3*D[n]^2*a[1]*a[2]^6+13568*n^3*D[n]*a[1]^5*a[3]^3-19104*n^3*D[n]*a[1]^4*a[2]^2*a
[3]^2+7182*n^3*D[n]*a[1]^3*a[2]^4*a[3]-810*n^3*D[n]*a[1]^2*a[2]^6-12960*n^2*D[n]^3*a[1]^4*a[2]*a
[3]^2+6544*n^2*D[n]^3*a[1]^3*a[2]^3*a[3]-819*n^2*D[n]^3*a[1]^2*a[2]^5-33848*n^2*D[n]^2*a[1]^5*a[
2]*a[3]^2+17172*n^2*D[n]^2*a[1]^4*a[2]^3*a[3]-2160*n^2*D[n]^2*a[1]^3*a[2]^5+1208*n*D[n]^3*a[1]^6
*a[3]^2-650*n*D[n]^3*a[1]^5*a[2]^2*a[3]+87*n*D[n]^3*a[1]^4*a[2]^4+2576*n*D[n]^2*a[1]^7*a[3]^2-\
1388*n*D[n]^2*a[1]^6*a[2]^2*a[3]+186*n*D[n]^2*a[1]^5*a[2]^4+2916*n^4*D[n]^3*a[3]^4+15552*n^4*D[n
]^2*a[1]*a[3]^4-648*n^4*D[n]^2*a[2]^2*a[3]^3+13824*n^4*D[n]*a[1]^2*a[3]^4-36288*n^4*D[n]*a[1]*a[
2]^2*a[3]^3+8100*n^4*D[n]*a[2]^4*a[3]^2+8192*n^4*a[1]^3*a[3]^4-2304*n^4*a[1]^2*a[2]^2*a[3]^3-\
30537*n^3*D[n]^3*a[1]*a[2]*a[3]^3+7317*n^3*D[n]^3*a[2]^3*a[3]^2-115776*n^3*D[n]^2*a[1]^2*a[2]*a[
3]^3+31140*n^3*D[n]^2*a[1]*a[2]^3*a[3]^2-783*n^3*D[n]^2*a[2]^5*a[3]-25344*n^3*D[n]*a[1]^3*a[2]*a
[3]^3+57168*n^3*D[n]*a[1]^2*a[2]^3*a[3]^2-22599*n^3*D[n]*a[1]*a[2]^5*a[3]+2430*n^3*D[n]*a[2]^7+
16524*n^2*D[n]^3*a[1]^3*a[3]^3+20439*n^2*D[n]^3*a[1]^2*a[2]^2*a[3]^2-11862*n^2*D[n]^3*a[1]*a[2]^
4*a[3]+1404*n^2*D[n]^3*a[2]^6+49704*n^2*D[n]^2*a[1]^4*a[3]^3+52800*n^2*D[n]^2*a[1]^3*a[2]^2*a[3]
^2-32148*n^2*D[n]^2*a[1]^2*a[2]^4*a[3]+3888*n^2*D[n]^2*a[1]*a[2]^6+15872*n^2*D[n]*a[1]^5*a[3]^3-\
22236*n^2*D[n]*a[1]^4*a[2]^2*a[3]^2+8364*n^2*D[n]*a[1]^3*a[2]^4*a[3]-945*n^2*D[n]*a[1]^2*a[2]^6-\
9480*n*D[n]^3*a[1]^4*a[2]*a[3]^2+4829*n*D[n]^3*a[1]^3*a[2]^3*a[3]-609*n*D[n]^3*a[1]^2*a[2]^5-\
21496*n*D[n]^2*a[1]^5*a[2]*a[3]^2+11004*n*D[n]^2*a[1]^4*a[2]^3*a[3]-1395*n*D[n]^2*a[1]^3*a[2]^5+
240*D[n]^3*a[1]^6*a[3]^2-132*D[n]^3*a[1]^5*a[2]^2*a[3]+18*D[n]^3*a[1]^4*a[2]^4+480*D[n]^2*a[1]^7
*a[3]^2-264*D[n]^2*a[1]^6*a[2]^2*a[3]+36*D[n]^2*a[1]^5*a[2]^4+20736*n^4*D[n]*a[2]*a[3]^4-27648*n
^4*a[1]*a[2]*a[3]^4+6912*n^4*a[2]^3*a[3]^3+18225*n^3*D[n]^3*a[3]^4+73872*n^3*D[n]^2*a[1]*a[3]^4-\
3078*n^3*D[n]^2*a[2]^2*a[3]^3+44928*n^3*D[n]*a[1]^2*a[3]^4-119088*n^3*D[n]*a[1]*a[2]^2*a[3]^3+
26757*n^3*D[n]*a[2]^4*a[3]^2+14848*n^3*a[1]^3*a[3]^4-4224*n^3*a[1]^2*a[2]^2*a[3]^3-61722*n^2*D[n
]^3*a[1]*a[2]*a[3]^3+14877*n^2*D[n]^3*a[2]^3*a[3]^2-188784*n^2*D[n]^2*a[1]^2*a[2]*a[3]^3+51288*n
^2*D[n]^2*a[1]*a[2]^3*a[3]^2-1332*n^2*D[n]^2*a[2]^5*a[3]-30096*n^2*D[n]*a[1]^3*a[2]*a[3]^3+66504
*n^2*D[n]*a[1]^2*a[2]^3*a[3]^2-26298*n^2*D[n]*a[1]*a[2]^5*a[3]+2835*n^2*D[n]*a[2]^7+11934*n*D[n]
^3*a[1]^3*a[3]^3+14904*n*D[n]^3*a[1]^2*a[2]^2*a[3]^2-8742*n*D[n]^3*a[1]*a[2]^4*a[3]+1044*n*D[n]^
3*a[2]^6+31464*n*D[n]^2*a[1]^4*a[3]^3+33240*n*D[n]^2*a[1]^3*a[2]^2*a[3]^2-20547*n*D[n]^2*a[1]^2*
a[2]^4*a[3]+2511*n*D[n]^2*a[1]*a[2]^6+7672*n*D[n]*a[1]^5*a[3]^3-10596*n*D[n]*a[1]^4*a[2]^2*a[3]^
2+3978*n*D[n]*a[1]^3*a[2]^4*a[3]-450*n*D[n]*a[1]^2*a[2]^6-1872*D[n]^3*a[1]^4*a[2]*a[3]^2+978*D[n
]^3*a[1]^3*a[2]^3*a[3]-126*D[n]^3*a[1]^2*a[2]^5-3984*D[n]^2*a[1]^5*a[2]*a[3]^2+2088*D[n]^2*a[1]^
4*a[2]^3*a[3]-270*D[n]^2*a[1]^3*a[2]^5+27648*n^4*a[3]^5+67392*n^3*D[n]*a[2]*a[3]^4-49920*n^3*a[1
]*a[2]*a[3]^4+12672*n^3*a[2]^3*a[3]^3+36450*n^2*D[n]^3*a[3]^4+119232*n^2*D[n]^2*a[1]*a[3]^4-5184
*n^2*D[n]^2*a[2]^2*a[3]^3+51984*n^2*D[n]*a[1]^2*a[3]^4-136176*n^2*D[n]*a[1]*a[2]^2*a[3]^3+30762*
n^2*D[n]*a[2]^4*a[3]^2+4864*n^2*a[1]^3*a[3]^4-1392*n^2*a[1]^2*a[2]^2*a[3]^3-44307*n*D[n]^3*a[1]*
a[2]*a[3]^3+10827*n*D[n]^3*a[2]^3*a[3]^2-118800*n*D[n]^2*a[1]^2*a[2]*a[3]^3+33084*n*D[n]^2*a[1]*
a[2]^3*a[3]^2-945*n*D[n]^2*a[2]^5*a[3]-15156*n*D[n]*a[1]^3*a[2]*a[3]^3+31752*n*D[n]*a[1]^2*a[2]^
3*a[3]^2-12501*n*D[n]*a[1]*a[2]^5*a[3]+1350*n*D[n]*a[2]^7+2268*D[n]^3*a[1]^3*a[3]^3+2916*D[n]^3*
a[1]^2*a[2]^2*a[3]^2-1764*D[n]^3*a[1]*a[2]^4*a[3]+216*D[n]^3*a[2]^6+5808*D[n]^2*a[1]^4*a[3]^3+
6000*D[n]^2*a[1]^3*a[2]^2*a[3]^2-3870*D[n]^2*a[1]^2*a[2]^4*a[3]+486*D[n]^2*a[1]*a[2]^6+1272*D[n]
*a[1]^5*a[3]^3-1704*D[n]*a[1]^4*a[2]^2*a[3]^2+636*D[n]*a[1]^3*a[2]^4*a[3]-72*D[n]*a[1]^2*a[2]^6+
48384*n^3*a[3]^5+75600*n^2*D[n]*a[2]*a[3]^4-16320*n^2*a[1]*a[2]*a[3]^4+4176*n^2*a[2]^3*a[3]^3+
25515*n*D[n]^3*a[3]^4+73872*n*D[n]^2*a[1]*a[3]^4-3726*n*D[n]^2*a[2]^2*a[3]^3+25092*n*D[n]*a[1]^2
*a[3]^4-62892*n*D[n]*a[1]*a[2]^2*a[3]^3+14283*n*D[n]*a[2]^4*a[3]^2-928*n*a[1]^3*a[3]^4+264*n*a[1
]^2*a[2]^2*a[3]^3-8262*D[n]^3*a[1]*a[2]*a[3]^3+2106*D[n]^3*a[2]^3*a[3]^2-21600*D[n]^2*a[1]^2*a[2
]*a[3]^3+6456*D[n]^2*a[1]*a[2]^3*a[3]^2-234*D[n]^2*a[2]^5*a[3]-2724*D[n]*a[1]^3*a[2]*a[3]^3+5136
*D[n]*a[1]^2*a[2]^3*a[3]^2-1998*D[n]*a[1]*a[2]^5*a[3]+216*D[n]*a[2]^7+15552*n^2*a[3]^5+33588*n*D
[n]*a[2]*a[3]^4+3120*n*a[1]*a[2]*a[3]^4-792*n*a[2]^3*a[3]^3+4374*D[n]^3*a[3]^4+12960*D[n]^2*a[1]
*a[3]^4-972*D[n]^2*a[2]^2*a[3]^3+4212*D[n]*a[1]^2*a[3]^4-9516*D[n]*a[1]*a[2]^2*a[3]^3+2178*D[n]*
a[2]^4*a[3]^2-336*a[1]^3*a[3]^4+96*a[1]^2*a[2]^2*a[3]^3-3024*n*a[3]^5+4644*D[n]*a[2]*a[3]^4+1128
*a[1]*a[2]*a[3]^4-288*a[2]^3*a[3]^3-1080*a[3]^5]:
Try(1,CreativeTelescoping(Integral,[n::shift]),res);

